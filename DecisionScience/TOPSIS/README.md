# TOPSIS: Technique for Order of Preference by Similarity to Ideal Solution

**How it works?:** Chosen alternative should have the shortest geometric distance from the positive ideal solution (PIS) and largest distance from the negative ideal solution (NIS).

There is an existing python package that can implement TOPSIS: [Link](https://github.com/Glitchfix/TOPSIS-Python/tree/master). I've taken the source code from here.


## Algorithm

1. Create a matrix of M alternatives and N variables.


I asked ChatGPT to create a CSV of 20 potential grooms with the following variables: `salary`, `height`, `weight`, `siblings`, `wealth`, `complexion`.

`complexion` and `siblings` are categorical variables.

$(a_{ij})_{M*N}$

i -> potential grooms

j -> variables

```
M = 20
N = 6
```

2. Normalise evaluation matrix

Each variable is normalised between 0-1

$\alpha_{ij} = \dfrac{a_{ij}} {\sqrt(\sum_{i=1}^M(a_{ij}^2))}$

3. Calculate the weighted normalised decision matrix

Each variable should have a weight $w_j$ such that $\sum_{j=1}^Nw_j = 1$

These weights can be generated by expert consultation or by data driven ways.

Weighted normalised decision matrix: $\chi_{ij} = \alpha_{ij} * w_j$

4. Determine the best and worst cases for each variable

Now what is a best case is generally subjective - especially with categorical variables.

By convention, variables are defined in such a way that the more the better. More salary is better. More wealth is better. All TOPSIS packages have this assumption.

Categorical variables are generally label encoded for TOPSIS. Encode them in such a way that bigger number is for the best case. For instance, going by the assumption that `fair complexion` is considered better, it would be encoded a value 3, `wheatish`=2; `dark`=1.

PS: This is morally and politically wrong. But decisions are taken based on preferences of the decision maker.

Best case for each variable:
$\chi_j^b = max_{i=1}^M X_{ij}$

Worst case for each variable:
$\chi_j^w = min_{i=1}^M X_{ij}$

5. Calculate euclidean distance between each alternative and the best/worst cases

Distance from best
$d_i^b = \sqrt (\sum_{j=1}^N  (\chi_{ij} - \chi_j^b)^2)$

Distance from worst
$d_i^w = \sqrt (\sum_{j=1}^N  (\chi_{ij} - \chi_j^w)^2)$

6. Calculate TOPSIS Scores for each alternative

$s_i = \dfrac{d_i^w} {d_i^w + d_i^b}$

Higher the score, better the alternative (closest to PIS).
Rank accordingly.

## Use cases of TOPSIS
1. Selection of vendors, softwares, sites etc.
2. We can use TOPSIS to rank students (any ranking). Would it be better than the current ranking system? TOPSIS is compensatory
3. Reverse engineering a decision already taken using TOPSIS weightages shows the value system.

## Challenges with TOPSIS:
1. If the categorical variable is a nominal variable. That variable cannot be used in TOPSIS. Ordinal variables can be included.

## References:
1. [What is TOPSIS? By Robert Soczewica](https://robertsoczewica.medium.com/what-is-topsis-b05c50b3cd05)
